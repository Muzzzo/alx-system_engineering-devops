#!/bin/bash

# Check if Nginx is already listening on port 80
if curl -s 0:80 >/dev/null 2>&1; then
    echo "Nginx is already listening on port 80"
else
    # Configure Nginx to listen on port 80
    sed -i 's/listen [::]:80 default_server;/listen 80 default_server;/g' /etc/nginx/nginx.conf

    # Restart Nginx service
    systemctl restart nginx

    # Wait for Nginx to restart
    sleep 2

    # Check if Nginx is now listening on port 80
    if curl -s 0:80 >/dev/null 2>&1; then
        echo "Nginx is now listening on port 80"
    else
        echo "Failed to configure Nginx to listen on port 80"
        exit 1
    fi
fi
